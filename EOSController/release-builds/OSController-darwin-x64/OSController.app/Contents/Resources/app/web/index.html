<!DOCTYPE html>
<html>
    <head>
        <title>OSController Web</title>
        <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
        <meta charset="UTF-8" />
        <script src="node_modules/NexusUI.js"></script>
        <script src="node_modules/jquery/dist/jquery.js"></script>
        <script src="node_modules/osc/dist/osc-browser.min.js"></script>
        <style> 
            h1{
            font-family: 'Open Sans';
            text-align:center;
            }
            input {
                display: block;
                margin-left: auto;
                margin-right: auto;
                }
            button{
                display: block;
                margin-left: auto;
                margin-right: auto;
                margin-top: 20px
            }
            div{
                display: block;
                margin-left: auto;
                margin-right: auto;
                margin-top: 10px
            }
        </style>
    </head>


    <body>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300" type="text/css" />

        <h1>OSController Web</h1>

        <input type="text" id="inputtext" value="">

        <div id="slider1"></div>
        <div id="slider2"></div>
        <div id="slider3"></div>
        <div id="slider4"></div>
        <div id="slider5"></div>
        <div id="slider6"></div>
        <div id="slider7"></div>
        <div id="slider8"></div>


        <div id="toggle1"></div>
        <div id="toggle2"></div>
        <div id="toggle3"></div>
        <div id="toggle4"></div>
        <div id="toggle5"></div>
        <div id="toggle6"></div>
        <div id="toggle7"></div>
        <div id="toggle8"></div>

        <div id="position1"></div>

        <div id="tilt1"></div>

        <script> 

        var button = document.createElement("button");
        button.innerHTML = "Connect";

        var body = document.getElementsByTagName("body")[0];
        body.appendChild(button);

        button.addEventListener ("click", function() {

            button.parentNode.removeChild(button);

            var ip = document.getElementById("inputtext").value;

            var slider1 = new Nexus.Slider('#slider1')
            var slider2 = new Nexus.Slider('#slider2')
            var slider3 = new Nexus.Slider('#slider3')
            var slider4 = new Nexus.Slider('#slider4')
            var slider5 = new Nexus.Slider('#slider5')
            var slider6 = new Nexus.Slider('#slider6')
            var slider7 = new Nexus.Slider('#slider7')
            var slider8 = new Nexus.Slider('#slider8')

            var toggle1 = new Nexus.Toggle('#toggle1')
            var toggle2 = new Nexus.Toggle('#toggle2')
            var toggle3 = new Nexus.Toggle('#toggle3')
            var toggle4 = new Nexus.Toggle('#toggle4')
            var toggle5 = new Nexus.Toggle('#toggle5')
            var toggle6 = new Nexus.Toggle('#toggle6')
            var toggle7 = new Nexus.Toggle('#toggle7')
            var toggle8 = new Nexus.Toggle('#toggle8')

            var position1 = new Nexus.Position('#position1')

            var tilt1 = new Nexus.Tilt('#tilt1')

            var websock = "ws://";
            var port = ":8081";

            u = websock.concat(ip, port);

            var port = new osc.WebSocketPort({
            url: u
            });

            port.on("message", function (oscMessage) {
            $("#message").text(JSON.stringify(oscMessage, undefined, 2));
            console.log("message", oscMessage);
            });

            port.open();

            var sendvalue = function (path,value) {
                port.send({
                    address: path,
                    args: [value]
                });
            };
            
            slider1.on('change',function(v) {
            sendvalue("/slider1",v);
                })

            slider2.on('change',function(v) {
            sendvalue("/slider2",v);
                })

            slider3.on('change',function(v) {
            sendvalue("/slider3",v);
                })

            slider4.on('change',function(v) {
            sendvalue("/slider4",v);
                })  

            slider5.on('change',function(v) {
            sendvalue("/slider5",v);
                })  
            slider6.on('change',function(v) {
            sendvalue("/slider6",v);
                })  
            slider7.on('change',function(v) {
            sendvalue("/slider7",v);
                })  
            slider8.on('change',function(v) {
            sendvalue("/slider8",v);
                })

            toggle1.on('change',function(v) {
            sendvalue("/toggle1",v);
                })

            toggle2.on('change',function(v) {
            sendvalue("/toggle2",v);
                })

            toggle3.on('change',function(v) {
            sendvalue("/toggle3",v);
                })

            toggle4.on('change',function(v) {
            sendvalue("/toggle4",v);
                })  

            toggle5.on('change',function(v) {
            sendvalue("/toggle5",v);
                })  
            toggle6.on('change',function(v) {
            sendvalue("/toggle6",v);
                })  
            toggle7.on('change',function(v) {
            sendvalue("/toggle7",v);
                })  
            toggle8.on('change',function(v) {
            sendvalue("/toggle8",v);
                })
    
            position1.on('change',function(v) {
            sendvalue("/positionX",v.x);
            sendvalue("/positionY",v.y);
            })

            tilt1.on('change',function(v) {
            sendvalue("/tiltX",v.x);
            sendvalue("/tiltY",v.y);
            })

            });
            
        </script>
    </body>
</html>
